---
title: "NPP delivery - National & Regional"
output:
  beamer_presentation:
    latex_engine: pdflatex
    slide_level: 2
    toc: false
    includes:
      in_header: slide_format2.tex
  slidy_presentation: default
sansfont: Calibri Light
fontsize: 8pt
classoption: aspectratio = 169
##always_allow_html: true
---

```{r libraries, include=FALSE}
library(tidyverse)
library(readxl)
library(DBI)
library(odbc)
library(reactable)
library(downloadthis)
library(lubridate)
library(knitr)
library(ggrepel)
library(ggpubr)
library(gridExtra)
options(htmltools.dir.version = FALSE, htmltools.preserve.raw = FALSE)
options(knitr.duplicate.label = 'allow')

source(knitr::purl("NPP_activity_functions.Rmd", output = tempfile()))
```

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

## NPP activity to date against previous year's delivery

```{r plot chart, echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot <- plot_npp_activity_monitoring(level = "National", 
                                     region_STP_name = NULL)

table <- table_npp_monitoring(level = "National", 
                                     region_STP_name = NULL)

grid.arrange(plot, table, nrow = 1, widths = c(1, 1, 1), 
             layout_matrix = rbind(c(1, 1, 2)))
```

-   Data before the NPP was introduced is taken from eDEN, while data after the introduction of the NPP (excluding unpaid) is from COMPASS. This is because it is not possible to replicate the COMPASS method on eDEN data to compare activity delivered prior to the NPP's introduction. The table shows the difference between COMPASS and eDEN data for months where we have both sources.
-   This data is not standardised by working day, so some of the difference between months may be due to differences in the number of working days.

## NPP activity to date against previous year's delivery - East Of England

```{r plot chart reg1, echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot <- plot_npp_activity_monitoring(level = "Regional", 
                             region_STP_name = "East Of England")

table <- table_npp_monitoring(level = "Regional", 
                             region_STP_name = "East Of England")

grid.arrange(plot, table, nrow = 1, widths = c(1, 1, 1), 
             layout_matrix = rbind(c(1, 1, 2)))
```

-   Data before the NPP was introduced is taken from eDEN, while data after the introduction of the NPP (excluding unpaid) is from COMPASS. This is because it is not possible to replicate the COMPASS method on eDEN data to compare activity delivered prior to the NPP's introduction. The table shows the difference between COMPASS and eDEN data for months where we have both sources.
-   This data is not standardised by working day, so some of the difference between months may be due to differences in the number of working days.

## NPP activity to date against previous year's delivery - London

```{r plot chart reg2, echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot <- plot_npp_activity_monitoring(level = "Regional", 
                             region_STP_name = "London")

table <- table_npp_monitoring(level = "Regional", 
                             region_STP_name = "London")

grid.arrange(plot, table, nrow = 1, widths = c(1, 1, 1), 
             layout_matrix = rbind(c(1, 1, 2)))
```

-   Data before the NPP was introduced is taken from eDEN, while data after the introduction of the NPP (excluding unpaid) is from COMPASS. This is because it is not possible to replicate the COMPASS method on eDEN data to compare activity delivered prior to the NPP's introduction. The table shows the difference between COMPASS and eDEN data for months where we have both sources.
-   This data is not standardised by working day, so some of the difference between months may be due to differences in the number of working days.

## NPP activity to date against previous year's delivery - Midlands

```{r plot chart reg3, echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot <- plot_npp_activity_monitoring(level = "Regional", 
                             region_STP_name = "Midlands")

table <- table_npp_monitoring(level = "Regional", 
                             region_STP_name = "Midlands")

grid.arrange(plot, table, nrow = 1, widths = c(1, 1, 1), 
             layout_matrix = rbind(c(1, 1, 2)))
```

-   Data before the NPP was introduced is taken from eDEN, while data after the introduction of the NPP (excluding unpaid) is from COMPASS. This is because it is not possible to replicate the COMPASS method on eDEN data to compare activity delivered prior to the NPP's introduction. The table shows the difference between COMPASS and eDEN data for months where we have both sources.
-   This data is not standardised by working day, so some of the difference between months may be due to differences in the number of working days.

## NPP activity to date against previous year's delivery - North East And Yorkshire

```{r plot chart reg4, echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot <- plot_npp_activity_monitoring(level = "Regional", 
                             region_STP_name = "North East And Yorkshire")

table <- table_npp_monitoring(level = "Regional", 
                             region_STP_name = "North East And Yorkshire")

grid.arrange(plot, table, nrow = 1, widths = c(1, 1, 1), 
             layout_matrix = rbind(c(1, 1, 2)))
```

-   Data before the NPP was introduced is taken from eDEN, while data after the introduction of the NPP (excluding unpaid) is from COMPASS. This is because it is not possible to replicate the COMPASS method on eDEN data to compare activity delivered prior to the NPP's introduction. The table shows the difference between COMPASS and eDEN data for months where we have both sources.
-   This data is not standardised by working day, so some of the difference between months may be due to differences in the number of working days.

## NPP activity to date against previous year's delivery - North West

```{r plot chart reg5, echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot <- plot_npp_activity_monitoring(level = "Regional", 
                             region_STP_name = "North West")

table <- table_npp_monitoring(level = "Regional", 
                             region_STP_name = "North West")

grid.arrange(plot, table, nrow = 1, widths = c(1, 1, 1), 
             layout_matrix = rbind(c(1, 1, 2)))
```

-   Data before the NPP was introduced is taken from eDEN, while data after the introduction of the NPP (excluding unpaid) is from COMPASS. This is because it is not possible to replicate the COMPASS method on eDEN data to compare activity delivered prior to the NPP's introduction. The table shows the difference between COMPASS and eDEN data for months where we have both sources.
-   This data is not standardised by working day, so some of the difference between months may be due to differences in the number of working days.

## NPP activity to date against previous year's delivery - South East

```{r plot chart reg6, echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot <- plot_npp_activity_monitoring(level = "Regional", 
                             region_STP_name = "South East")

table <- table_npp_monitoring(level = "Regional", 
                             region_STP_name = "South East")

grid.arrange(plot, table, nrow = 1, widths = c(1, 1, 1), 
             layout_matrix = rbind(c(1, 1, 2)))
```

-   Data before the NPP was introduced is taken from eDEN, while data after the introduction of the NPP (excluding unpaid) is from COMPASS. This is because it is not possible to replicate the COMPASS method on eDEN data to compare activity delivered prior to the NPP's introduction. The table shows the difference between COMPASS and eDEN data for months where we have both sources.
-   This data is not standardised by working day, so some of the difference between months may be due to differences in the number of working days.

## NPP activity to date against previous year's delivery - South West

```{r plot chart reg7, echo = FALSE, warning = FALSE, message = FALSE, fig.width=14, fig.height=5}
plot <- plot_npp_activity_monitoring(level = "Regional", 
                             region_STP_name = "South West")

table <- table_npp_monitoring(level = "Regional", 
                             region_STP_name = "South West")

grid.arrange(plot, table, nrow = 1, widths = c(1, 1, 1), 
             layout_matrix = rbind(c(1, 1, 2)))
```

-   Data before the NPP was introduced is taken from eDEN, while data after the introduction of the NPP (excluding unpaid) is from COMPASS. This is because it is not possible to replicate the COMPASS method on eDEN data to compare activity delivered prior to the NPP's introduction. The table shows the difference between COMPASS and eDEN data for months where we have both sources.
-   This data is not standardised by working day, so some of the difference between months may be due to differences in the number of working days.
